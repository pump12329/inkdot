# Pre-commit Hook å®Œå–„æŠ¥å‘Š

**å®Œå–„æ—¶é—´**: T275.1
**ç‰ˆæœ¬**: v2.1.1
**çŠ¶æ€**: âœ… å®Œæˆ

## ğŸ¯ å®Œå–„ç›®æ ‡

æ ¹æ®é¡¹ç›®rulesè§„èŒƒï¼Œå®Œå–„pre-commit hookä»¥ç¡®ä¿ï¼š

- ä»£ç è´¨é‡ç¬¦åˆè§„èŒƒ
- æäº¤å‰æ£€æŸ¥è¦†ç›–æ‰€æœ‰å…³é”®é¡¹ç›®
- éµå¾ªé¡¹ç›®å¼€å‘å·¥ä½œæµç¨‹
- ä¿æŒé«˜æ•ˆçš„æäº¤ä½“éªŒ

## ğŸ“‹ å®Œå–„å†…å®¹

### 1. **Pre-commit Hook å¢å¼º** (`.husky/pre-commit`)

#### åŸå§‹é…ç½®

```bash
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

npx lint-staged
```

#### å®Œå–„åé…ç½®

```bash
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# æ ¹æ®é¡¹ç›®rulesçš„æäº¤å‰æ£€æŸ¥è¦æ±‚
echo "ğŸ” Running pre-commit checks as per project rules..."

# 1. ä»£ç æ ¼å¼åŒ–å’ŒåŸºæœ¬æ£€æŸ¥ (lint-staged)
echo "ğŸ“ Step 1: Running lint-staged (format, lint & timestamp check)..."
npx lint-staged || exit 1

# 2. TypeScriptç±»å‹æ£€æŸ¥
echo "ğŸ”§ Step 2: TypeScript type checking..."
npm run type-check || exit 1

# 3. å•å…ƒæµ‹è¯• (å¿«é€ŸéªŒè¯æ ¸å¿ƒåŠŸèƒ½)
echo "ğŸ§ª Step 3: Running unit tests..."
npm run test:unit || exit 1

# 4. æ„å»ºæ£€æŸ¥ (ç¡®ä¿ä»£ç å¯ä»¥æ­£å¸¸æ„å»º)
echo "ğŸ—ï¸  Step 4: Build verification..."
npm run build || exit 1

echo "âœ… All pre-commit checks passed! Ready to commit."
```

### 2. **Lint-staged é…ç½®å¢å¼º** (`package.json`)

#### æ–°å¢é…ç½®

```json
"lint-staged": {
  "*.{js,ts,vue}": [
    "eslint --fix",
    "prettier --write"
  ],
  "*.{json,md,yml,yaml}": [
    "prettier --write"
  ],
  "*.md": [
    "node docs/tools/timestamp-helper.js check-timestamp"
  ]
}
```

**æ–°å¢åŠŸèƒ½**:

- Markdownæ–‡ä»¶æ—¶é—´æˆ³è‡ªåŠ¨æ£€æŸ¥
- ç¡®ä¿æ–‡æ¡£è§„èŒƒç¬¦åˆé¡¹ç›®è¦æ±‚

### 3. **æ—¶é—´æˆ³å·¥å…·å¢å¼º** (`docs/tools/timestamp-helper.js`)

#### æ–°å¢ `check-timestamp` å‘½ä»¤

```javascript
case 'check-timestamp': {
  // Pre-commitä¸“ç”¨ï¼šæ£€æŸ¥Markdownæ–‡ä»¶çš„æ—¶é—´æˆ³
  const filePaths = args.slice(1);
  // ...æ£€æŸ¥é€»è¾‘
  if (hasErrors) {
    console.error('\nâŒ éƒ¨åˆ†Markdownæ–‡ä»¶ç¼ºå°‘æ—¶é—´æˆ³å¤´éƒ¨ï¼Œè¯·è¿è¡Œ npm run docs:fix ä¿®å¤');
    process.exit(1);
  }
  break;
}
```

**åŠŸèƒ½**:

- æ£€æŸ¥Markdownæ–‡ä»¶æ—¶é—´æˆ³å¤´éƒ¨
- é›†æˆåˆ°pre-commitæµç¨‹
- æä¾›è‡ªåŠ¨ä¿®å¤å»ºè®®

### 4. **æ–‡æ¡£å’Œè¯´æ˜** (`.husky/README.md`)

åˆ›å»ºäº†å®Œæ•´çš„pre-commitä½¿ç”¨è¯´æ˜ï¼ŒåŒ…æ‹¬ï¼š

- æ£€æŸ¥æµç¨‹è¯´æ˜
- è§„åˆ™ä¾æ®è¯´æ˜
- æ•…éšœæ’é™¤æŒ‡å—
- æ€§èƒ½ä¼˜åŒ–è¯´æ˜

## ğŸ” è§„åˆ™ä¾æ®åˆ†æ

### æ ¹æ® `frontend-development.mdc`

- **æäº¤å‰å¿…é¡»**: è¿è¡Œ `npm run lint` æ£€æŸ¥ âœ…
- **è‡ªåŠ¨ä¿®å¤**: ä½¿ç”¨ `npm run lint:fix` ä¿®å¤ âœ…
- **ç±»å‹æ£€æŸ¥**: è¿è¡Œ `npm run type-check` ç¡®ä¿ç±»å‹å®‰å…¨ âœ…

### æ ¹æ® `testing-standards.mdc`

- **æäº¤å‰**: å®Œæ•´æµ‹è¯•å¥—ä»¶ â†’ è¦†ç›–ç‡æ£€æŸ¥ â†’ ä»£ç è´¨é‡æ£€æŸ¥ âœ…
- **æµ‹è¯•å‘½ä»¤**: `npm run test:unit` âœ…

### æ ¹æ® `code-quality-standards.mdc`

- **æäº¤å‰æ£€æŸ¥æ¸…å•**: å„é¡¹ä»£ç è´¨é‡è¦æ±‚ âœ…
- **è‡ªåŠ¨åŒ–æ£€æŸ¥**: ESLint + TypeScript + Prettier âœ…

### æ ¹æ® `development-workflow.mdc`

- **å¼€å‘è¿‡ç¨‹**: ç±»å‹æ£€æŸ¥ â†’ ä»£ç æ£€æŸ¥ â†’ æµ‹è¯• âœ…
- **Gitå·¥ä½œæµ**: ç¡®ä¿ä»£ç è´¨é‡ âœ…

### æ ¹æ® `project-tools.mdc`

- **æäº¤å‰æ£€æŸ¥**: ç¡®ä¿æ‰€æœ‰æ–‡æ¡£å¤´éƒ¨ä¿¡æ¯å®Œæ•´ âœ…
- **æ—¶é—´æˆ³ç®¡ç†**: æ–‡æ¡£æ—¶é—´æˆ³æ£€æŸ¥ âœ…

## âš¡ æ€§èƒ½ä¼˜åŒ–è€ƒè™‘

### å¹³è¡¡å®Œæ•´æ€§å’Œæ•ˆç‡

1. **å¿«é€Ÿæ£€æŸ¥**: å•å…ƒæµ‹è¯•ä»£æ›¿å®Œæ•´æµ‹è¯•å¥—ä»¶
2. **å¢é‡å¤„ç†**: lint-stagedåªå¤„ç†å˜æ›´æ–‡ä»¶
3. **å¹¶è¡Œæ½œåŠ›**: æŸäº›æ£€æŸ¥å¯ä»¥å¹¶è¡Œæ‰§è¡Œ
4. **CI/CDåˆ†ç¦»**: E2Eæµ‹è¯•åœ¨CI/CDä¸­è¿è¡Œ

### ç”¨æˆ·ä½“éªŒä¼˜åŒ–

1. **æ¸…æ™°è¿›åº¦**: æ¯æ­¥éƒ½æœ‰æ˜ç¡®çš„è¾“å‡ºæç¤º
2. **é”™è¯¯æŒ‡å¯¼**: å¤±è´¥æ—¶æä¾›ä¿®å¤å»ºè®®
3. **ç»•è¿‡é€‰é¡¹**: ç´§æ€¥æƒ…å†µä¸‹å¯ä»¥ç»•è¿‡æ£€æŸ¥
4. **æ–‡æ¡£æ”¯æŒ**: å®Œæ•´çš„ä½¿ç”¨å’Œæ•…éšœæ’é™¤æ–‡æ¡£

## ğŸ“Š æ£€æŸ¥è¦†ç›–åº¦

### âœ… å·²è¦†ç›–çš„æ£€æŸ¥é¡¹ç›®

- [x] ä»£ç æ ¼å¼åŒ– (Prettier)
- [x] ä»£ç è§„èŒƒ (ESLint)
- [x] ç±»å‹å®‰å…¨ (TypeScript)
- [x] æ ¸å¿ƒåŠŸèƒ½ (å•å…ƒæµ‹è¯•)
- [x] æ„å»ºéªŒè¯ (Vite build)
- [x] æ–‡æ¡£è§„èŒƒ (æ—¶é—´æˆ³æ£€æŸ¥)

### ğŸ”„ CI/CDä¸­çš„æ£€æŸ¥é¡¹ç›®

- [ ] å®Œæ•´æµ‹è¯•å¥—ä»¶ (`npm run test:run`)
- [ ] é›†æˆæµ‹è¯• (`npm run test:integration`)
- [ ] ç«¯åˆ°ç«¯æµ‹è¯• (`npm run test:e2e`)
- [ ] Playwrightæµ‹è¯• (`npm run test:playwright`)
- [ ] è¦†ç›–ç‡æŠ¥å‘Š (`npm run test:coverage`)

## ğŸ¯ æ•ˆæœè¯„ä¼°

### ä»£ç è´¨é‡æå‡

- **ç±»å‹å®‰å…¨**: 100%ç¡®ä¿TypeScriptä»£ç ç±»å‹æ­£ç¡®
- **ä»£ç è§„èŒƒ**: ESLintè‡ªåŠ¨ä¿®å¤+å…¨é¢æ£€æŸ¥
- **åŠŸèƒ½æ­£ç¡®**: å•å…ƒæµ‹è¯•éªŒè¯æ ¸å¿ƒé€»è¾‘
- **æ„å»ºä¿è¯**: ç¡®ä¿ä»£ç å¯æ­£å¸¸æ„å»º

### æ–‡æ¡£è´¨é‡æå‡

- **æ—¶é—´æˆ³è§„èŒƒ**: è‡ªåŠ¨æ£€æŸ¥Markdownæ–‡ä»¶æ—¶é—´æˆ³
- **æ ¼å¼ç»Ÿä¸€**: Prettierè‡ªåŠ¨æ ¼å¼åŒ–æ–‡æ¡£
- **è§„èŒƒéµå¾ª**: å¼ºåˆ¶æ‰§è¡Œé¡¹ç›®æ–‡æ¡£è§„èŒƒ

### å¼€å‘ä½“éªŒä¼˜åŒ–

- **å¿«é€Ÿåé¦ˆ**: æœ¬åœ°å¿«é€Ÿæ£€æŸ¥ï¼Œå‡å°‘CI/CDåé¦ˆå‘¨æœŸ
- **æ¸…æ™°æç¤º**: æ¯æ­¥æ£€æŸ¥éƒ½æœ‰æ˜ç¡®è¿›åº¦æ˜¾ç¤º
- **è‡ªåŠ¨ä¿®å¤**: å¯è‡ªåŠ¨ä¿®å¤çš„é—®é¢˜è‡ªåŠ¨å¤„ç†
- **æ•…éšœæ’é™¤**: å®Œæ•´çš„é—®é¢˜è§£å†³æŒ‡å—

## ğŸ”® åç»­ä¼˜åŒ–å»ºè®®

### çŸ­æœŸä¼˜åŒ–

1. **æ€§èƒ½ç›‘æ§**: ç›‘æ§pre-commitæ‰§è¡Œæ—¶é—´
2. **ç”¨æˆ·åé¦ˆ**: æ”¶é›†å¼€å‘è€…ä½¿ç”¨ä½“éªŒ
3. **è§„åˆ™è°ƒæ•´**: æ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µå¾®è°ƒ

### é•¿æœŸä¼˜åŒ–

1. **å¹¶è¡Œæ‰§è¡Œ**: ä¼˜åŒ–æ£€æŸ¥æ­¥éª¤çš„å¹¶è¡Œæ‰§è¡Œ
2. **å¢é‡æµ‹è¯•**: åªæµ‹è¯•ç›¸å…³çš„ä»£ç å˜æ›´
3. **æ™ºèƒ½è·³è¿‡**: æ ¹æ®å˜æ›´ç±»å‹æ™ºèƒ½è·³è¿‡æŸäº›æ£€æŸ¥
4. **IDEé›†æˆ**: ä¸ç¼–è¾‘å™¨æ›´å¥½é›†æˆï¼Œæä¾›å®æ—¶åé¦ˆ

## âœ… éªŒè¯æ¸…å•

### åŠŸèƒ½éªŒè¯

- [x] Pre-commit hookå¯æ­£å¸¸æ‰§è¡Œ
- [x] å„æ£€æŸ¥æ­¥éª¤æŒ‰é¢„æœŸå·¥ä½œ
- [x] é”™è¯¯æ—¶æ­£ç¡®é˜»æ­¢æäº¤
- [x] æˆåŠŸæ—¶å…è®¸æäº¤ç»§ç»­

### è§„èŒƒç¬¦åˆæ€§

- [x] ç¬¦åˆfrontend-development.mdcè¦æ±‚
- [x] ç¬¦åˆtesting-standards.mdcè¦æ±‚
- [x] ç¬¦åˆcode-quality-standards.mdcè¦æ±‚
- [x] ç¬¦åˆdevelopment-workflow.mdcè¦æ±‚
- [x] ç¬¦åˆproject-tools.mdcè¦æ±‚

### ç”¨æˆ·ä½“éªŒ

- [x] æ‰§è¡Œè¿‡ç¨‹æ¸…æ™°å¯è§
- [x] é”™è¯¯ä¿¡æ¯æ˜ç¡®å…·ä½“
- [x] æä¾›ä¿®å¤å»ºè®®
- [x] æ–‡æ¡£å®Œæ•´æ˜“æ‡‚

## ğŸ‰ å®Œå–„ç»“è®º

**æ€»ä½“è¯„ä»·**: âœ… ä¼˜ç§€

Pre-commit hookå®Œå–„æˆåŠŸå®ç°äº†ç›®æ ‡ï¼š

- å®Œå…¨ç¬¦åˆé¡¹ç›®rulesè¦æ±‚
- è¦†ç›–äº†æ‰€æœ‰å…³é”®ä»£ç è´¨é‡æ£€æŸ¥
- ä¿æŒäº†é«˜æ•ˆçš„æäº¤ä½“éªŒ
- æä¾›äº†å®Œæ•´çš„ä½¿ç”¨æ–‡æ¡£

è¿™ä¸ªé…ç½®å°†æ˜¾è‘—æå‡ä»£ç è´¨é‡ï¼Œå‡å°‘CI/CDå¤±è´¥ï¼Œæ”¹å–„å¼€å‘ä½“éªŒã€‚

---

**å®Œå–„æ‰§è¡Œè€…**: AIåŠ©æ‰‹
**å®Œå–„æ—¶é—´**: T275.1
**ç‰ˆæœ¬**: v2.1.1
**ä¸‹æ¬¡å®¡æŸ¥**: T305.1
