#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# æ ¹æ®é¡¹ç›®rulesçš„æäº¤å‰æ£€æŸ¥è¦æ±‚
echo "ğŸ” Running pre-commit checks as per project rules..."

# 1. ä»£ç æ ¼å¼åŒ–å’ŒåŸºæœ¬æ£€æŸ¥ (lint-staged)
echo "ğŸ“ Step 1: Running lint-staged (format, lint & timestamp check)..."
npx lint-staged || exit 1

# 2. TypeScriptç±»å‹æ£€æŸ¥
echo "ğŸ”§ Step 2: TypeScript type checking..."
npm run type-check || exit 1

# 3. å•å…ƒæµ‹è¯• (å¿«é€ŸéªŒè¯æ ¸å¿ƒåŠŸèƒ½)
echo "ğŸ§ª Step 3: Running unit tests..."
npm run test:unit || exit 1

# 4. æ„å»ºæ£€æŸ¥ (ç¡®ä¿ä»£ç å¯ä»¥æ­£å¸¸æ„å»º)
echo "ğŸ—ï¸  Step 4: Build verification..."
npm run build || exit 1

echo "âœ… All pre-commit checks passed! Ready to commit."
echo ""
echo "ğŸ“‹ Note: Full test suite and E2E tests will run in CI/CD pipeline."
echo "ğŸ’¡ To run full tests locally: npm run test:run"
